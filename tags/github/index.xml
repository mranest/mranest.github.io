
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
 <channel>
   <title>github on Anestis&#39; notes</title>
   <link>http://notes.georgiadis.online/tags/github/</link>
   <description>Recent content in github on Anestis&#39; notes</description>
   <generator>Hugo -- gohugo.io</generator>
   <language>en-us</language>
   <lastBuildDate>Sun, 02 Aug 2020 13:39:02 +0300</lastBuildDate>
   
       <atom:link href="http://notes.georgiadis.online/tags/github/index.xml" rel="self" type="application/rss+xml" />
   
   
     <item>
       <title>Openshift 4.x UPI on vSphere using Terraform</title>
       <link>http://notes.georgiadis.online/posts/openshift4-upi-vsphere-terraform/</link>
       <pubDate>Mon, 03 Aug 2020 11:24:46 +0300</pubDate>
       
       <guid>http://notes.georgiadis.online/posts/openshift4-upi-vsphere-terraform/</guid>
       <description>&lt;p&gt;Installing OpenShift 4.x has become massively easier and more straightforward after the CoreOS
acquisition from RedHat and the inclusion of &lt;del&gt;CoreOS&lt;/del&gt; RHCOS in the list of supported OSes.
vSphere has also been a supported platform for deployment since the initial versions, but up until
4.5 it has required a number of manual steps in order to complete the installation.&lt;/p&gt;
&lt;p&gt;Turns out complaints of RedHat customers running vSphere have led to Redhat offering an
installer-provisioned infrastructure (aka IPI), starting with v4.5. This however makes a number of
assumptions on the way vSphere is running that might not be acceptable with older installations
(e.g. assumes NSX-T networking).&lt;/p&gt;
&lt;p&gt;A second option is to make use of the UPI terraform scripts that have been available
for some time now under in the &lt;a href=&#34;https://github.com/openshift/installer&#34;&gt;OpenShift installer GitHub repository&lt;/a&gt;.
These however were originally targeting an AWS installation, and although this dependency seems to
have been removed there are other dependencies, like IPAM and a provisioned load-balancer that are
not necessarily available, or needed.&lt;/p&gt;
&lt;p&gt;A third option then is to use my reworked version of the OpenShift installer scripts that can be
found at:&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/mranest/openshift-upi-vsphere&#34;&gt;https://github.com/mranest/openshift-upi-vsphere&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;when-to-use&#34;&gt;When to use&lt;/h2&gt;
&lt;p&gt;Ideally you would want to take a look into my version of the scripts if:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You are running vSphere on-prem&lt;/li&gt;
&lt;li&gt;You want static IP provisioning&lt;/li&gt;
&lt;li&gt;You only want the bare minimal VMs (i.e. control plane, compute and optionally infra nodes)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;pre-requisites&#34;&gt;Pre-Requisites&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;DHCP server&lt;/li&gt;
&lt;li&gt;terraform&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;dhcp&#34;&gt;DHCP&lt;/h2&gt;
&lt;p&gt;A DHCP server is required, despite setting up static IPs. This is due to some design decision for
RHCOS that leads to the static IP configuration not being applied early enough in the boot phase.
My guess is that during boot the machine configuration provided by the machine config operator is
combined with the rest of configuration that is generated by the vm/ignition terraform module in
order to come up with the complete template.&lt;/p&gt;
&lt;p&gt;There is no need to configure the static IPs in the DHCP server configuration files, too; a generic
pool will suffice, along with a short lease time. See for example this sample configuration file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#/etc/dhcp/dhcpd.conf
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# DHCP Server Configuration file.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   see /usr/share/doc/dhcp*/dhcpd.conf.example
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#   see dhcpd.conf(5) man page
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;option&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;domain-name&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;cluster.example.com&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;default-lease-time&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;max-lease-time&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;120&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;authoritative&lt;/span&gt;;

&lt;span style=&#34;color:#66d9ef&#34;&gt;subnet&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.168.1.0&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;netmask&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.255.255.0&lt;/span&gt; {
        &lt;span style=&#34;color:#f92672&#34;&gt;option&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;routers&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.168.1.1&lt;/span&gt;;
        &lt;span style=&#34;color:#f92672&#34;&gt;option&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;subnet-mask&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.255.255.0&lt;/span&gt;;
        &lt;span style=&#34;color:#f92672&#34;&gt;option&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;domain-search&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;base.domain&amp;#34;&lt;/span&gt;;
        &lt;span style=&#34;color:#f92672&#34;&gt;option&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;domain-name-servers&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.168.0.1&lt;/span&gt;;
        &lt;span style=&#34;color:#f92672&#34;&gt;range&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.168.1.64&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;.168.1.128&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;build-a-cluster&#34;&gt;Build a Cluster&lt;/h2&gt;
&lt;h3 id=&#34;create-an-install-configyaml&#34;&gt;Create an &lt;code&gt;install-config.yaml&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Here is a sample configuration file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;apiVersion&lt;/span&gt;: v1
&lt;span style=&#34;color:#66d9ef&#34;&gt;baseDomain&lt;/span&gt;: example.com
&lt;span style=&#34;color:#66d9ef&#34;&gt;compute&lt;/span&gt;:
- &lt;span style=&#34;color:#66d9ef&#34;&gt;hyperthreading&lt;/span&gt;: Enabled
  &lt;span style=&#34;color:#66d9ef&#34;&gt;name&lt;/span&gt;: worker
  &lt;span style=&#34;color:#66d9ef&#34;&gt;replicas&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;controlPlane&lt;/span&gt;:
  &lt;span style=&#34;color:#66d9ef&#34;&gt;hyperthreading&lt;/span&gt;: Enabled
  &lt;span style=&#34;color:#66d9ef&#34;&gt;name&lt;/span&gt;: master
  &lt;span style=&#34;color:#66d9ef&#34;&gt;replicas&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;metadata&lt;/span&gt;:
  &lt;span style=&#34;color:#66d9ef&#34;&gt;name&lt;/span&gt;: cluster
&lt;span style=&#34;color:#66d9ef&#34;&gt;networking&lt;/span&gt;:
  &lt;span style=&#34;color:#66d9ef&#34;&gt;clusterNetwork&lt;/span&gt;:
  - &lt;span style=&#34;color:#66d9ef&#34;&gt;cidr&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;10.128.0.0&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;hostPrefix&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;networkType&lt;/span&gt;: OpenShiftSDN
    &lt;span style=&#34;color:#66d9ef&#34;&gt;serviceNetwork&lt;/span&gt;:
    - &lt;span style=&#34;color:#ae81ff&#34;&gt;172.26.0.0&lt;/span&gt;/&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;platform&lt;/span&gt;:
  &lt;span style=&#34;color:#66d9ef&#34;&gt;vsphere&lt;/span&gt;:
  &lt;span style=&#34;color:#66d9ef&#34;&gt;vcenter&lt;/span&gt;: vcenter.example.com
  &lt;span style=&#34;color:#66d9ef&#34;&gt;username&lt;/span&gt;: username
  &lt;span style=&#34;color:#66d9ef&#34;&gt;password&lt;/span&gt;: password
  &lt;span style=&#34;color:#66d9ef&#34;&gt;datacenter&lt;/span&gt;: datacenter
  &lt;span style=&#34;color:#66d9ef&#34;&gt;defaultDatastore&lt;/span&gt;: datastore
&lt;span style=&#34;color:#66d9ef&#34;&gt;pullSecret&lt;/span&gt;: YOUR_PULL_SECRET
&lt;span style=&#34;color:#66d9ef&#34;&gt;sshKey&lt;/span&gt;: YOUR_SSH_KEY
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Don&amp;rsquo;t pay attention to number of control plane and compute workers; these are actually
controlled by the terraform script. Also be sure to escape characters in vSphere settings
as required (e.g. any &lt;code&gt;/&lt;/code&gt; character must be escaped as &lt;code&gt;%2f&lt;/code&gt;). These settings are used for the
configuration of the vsphere in-tree storage driver.&lt;/p&gt;
&lt;p&gt;See also the relevant documentation for &lt;a href=&#34;https://docs.openshift.com/container-platform/4.5/installing/installing_vsphere/installing-vsphere.html#installation-initializing-manual_installing-vsphere&#34;&gt;Manually creating the installation configuration file&lt;/a&gt;
in OpenShift Documentation site for additional information on pull secrets, proxy settings
and other supported customizations.&lt;/p&gt;
&lt;h3 id=&#34;run-openshift-install-create-ignition-configs&#34;&gt;Run &lt;code&gt;openshift-install create ignition-configs&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;The three ignition files, &lt;code&gt;bootstrap.ign&lt;/code&gt;, &lt;code&gt;master.ign&lt;/code&gt; and &lt;code&gt;worker.ign&lt;/code&gt;, will be created.&lt;/p&gt;
&lt;p&gt;Don&amp;rsquo;t do any of the steps described in the
&lt;a href=&#34;https://docs.openshift.com/container-platform/4.5/installing/installing_vsphere/installing-vsphere.html#installation-vsphere-machines_installing-vsphere&#34;&gt;Creating Red Hat Enterprise Linux CoreOS (RHCOS) machines in vSphere&lt;/a&gt;
documentation section, as terraform will be used to create all the VMs required.&lt;/p&gt;
&lt;h3 id=&#34;create-a-terraformtfvars-configuraton-file&#34;&gt;Create a &lt;code&gt;terraform.tfvars&lt;/code&gt; configuraton file&lt;/h3&gt;
&lt;p&gt;There is an example &lt;code&gt;terraform.tfvars&lt;/code&gt; file in this directory named &lt;code&gt;terraform.tfvars.example&lt;/code&gt;. All
variables not preceded with &lt;code&gt;#&lt;/code&gt; need their value properly set (some sample values are provided),
whereas commented out variables have the default value shown.&lt;/p&gt;
&lt;p&gt;The ignition files created in the previous step should be copied in this folder, otherwise you
must set the location for them using the corresponding variables &lt;code&gt;bootstrap_ignition_path&lt;/code&gt;,
&lt;code&gt;control_plane_ignition_path&lt;/code&gt; and &lt;code&gt;compute_ignition_path&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you want to create infra nodes then you must provided their IP addresses in variable
&lt;code&gt;infra_ip_addresses&lt;/code&gt;. After cluster installation finishes you must follow
&lt;a href=&#34;https://www.redhat.com/en/blog/openshift-container-platform-4-how-does-machine-config-pool-work&#34;&gt;this guide&lt;/a&gt;
to properly configure infra nodes.&lt;/p&gt;
&lt;p&gt;If you want to provide more OS configuration files through ignition you must make the necessary
changes in file &lt;code&gt;vm/ignition.tf&lt;/code&gt;. If one for example wanted to add static routes to the resulting
RHCOS VM then the following highlighted changes would create file
&lt;code&gt;/etc/sysconfig/network-scripts/route-ens192&lt;/code&gt; after the OS boots (add a &lt;code&gt;route.tmpl&lt;/code&gt; file with the
appropriate static routes next to the &lt;code&gt;ignition.tf&lt;/code&gt; script)::&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;35
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;36
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;37
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;38
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;39
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;40
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;41
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;42
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;43
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;44
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;45
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;46
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;47
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;48
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;49
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;50
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;51
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;52
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;53
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;54
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;55
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;56
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;57
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;58
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-terraform&#34; data-lang=&#34;terraform&#34;&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ignition_file&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;static_routes&amp;#34;&lt;/span&gt; {
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;for_each&lt;/span&gt; = var.&lt;span style=&#34;color:#a6e22e&#34;&gt;hostnames_ip_addresses&lt;/span&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;filesystem&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;path&lt;/span&gt;       = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/etc/sysconfig/network-scripts/route-ens192&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;mode&lt;/span&gt;       = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;420&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;content&lt;/span&gt; {
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;content&lt;/span&gt; = file(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;path&lt;/span&gt;.module&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/route.tmpl&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;  }
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;}
&lt;/span&gt;&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ignition_config&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ign&amp;#34;&lt;/span&gt; {
  &lt;span style=&#34;color:#a6e22e&#34;&gt;for_each&lt;/span&gt; = var.&lt;span style=&#34;color:#a6e22e&#34;&gt;hostnames_ip_addresses&lt;/span&gt;

  &lt;span style=&#34;color:#a6e22e&#34;&gt;append&lt;/span&gt; {
    &lt;span style=&#34;color:#a6e22e&#34;&gt;source&lt;/span&gt; = &lt;span style=&#34;color:#a6e22e&#34;&gt;local&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;ignition_encoded&lt;/span&gt;
  }

  &lt;span style=&#34;color:#a6e22e&#34;&gt;files&lt;/span&gt; = [
&lt;span style=&#34;color:#66d9ef&#34;&gt;    data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;ignition_file&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;hostname&lt;/span&gt;[each.&lt;span style=&#34;color:#a6e22e&#34;&gt;key&lt;/span&gt;].&lt;span style=&#34;color:#a6e22e&#34;&gt;rendered&lt;/span&gt;,
&lt;span style=&#34;color:#66d9ef&#34;&gt;    data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;ignition_file&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;static_ip&lt;/span&gt;[each.&lt;span style=&#34;color:#a6e22e&#34;&gt;key&lt;/span&gt;].&lt;span style=&#34;color:#a6e22e&#34;&gt;rendered&lt;/span&gt;,
&lt;span style=&#34;display:block;width:100%;background-color:#3c3d38&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;    data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;ignition_file&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;static_routes&lt;/span&gt;[each.&lt;span style=&#34;color:#a6e22e&#34;&gt;key&lt;/span&gt;].&lt;span style=&#34;color:#a6e22e&#34;&gt;rendered&lt;/span&gt;,
&lt;/span&gt;  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;run-terraform-init&#34;&gt;Run &lt;code&gt;terraform init&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;This will intitialize this working directory with all the necessary plugins.&lt;/p&gt;
&lt;h3 id=&#34;run-terraform-apply&#34;&gt;Run &lt;code&gt;terraform apply&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Type &lt;code&gt;yes&lt;/code&gt; if everything looks ok for the VMs to be created.&lt;/p&gt;
&lt;h3 id=&#34;run-openshift-install-wait-for-bootstrap-complete&#34;&gt;Run &lt;code&gt;openshift-install wait-for bootstrap-complete&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Wait for the bootstrapping to complete.&lt;/p&gt;
&lt;h3 id=&#34;run-openshift-install-wait-for-install-complete&#34;&gt;Run &lt;code&gt;openshift-install wait-for install-complete&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Wait for the cluster install to finish. Enjoy your new OpenShift cluster.&lt;/p&gt;
&lt;h3 id=&#34;adding-new-rhcos-nodes&#34;&gt;Adding new RHCOS nodes&lt;/h3&gt;
&lt;p&gt;There are a number of RedHat knowledge base articles on how to add new RHCOS nodes (requires
RedHat subscription):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://access.redhat.com/solutions/4246261&#34;&gt;How to add OpenShift 4 RHCOS Worker Nodes in UPI in new installations (&amp;lt; 24 hours)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://access.redhat.com/solutions/4799921&#34;&gt;Adding worker nodes to the OCP 4 UPI cluster existing 24+ hours&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I can happily report that none of these are required when running OpenShift 4.5+. You need only
revisit &lt;code&gt;terraform.tfvars&lt;/code&gt; configuration file, add IPs to the class of nodes you want to scale
(&lt;code&gt;control_plane_ip_addresses&lt;/code&gt;, &lt;code&gt;infra_ip_addresses&lt;/code&gt; or &lt;code&gt;compute_ip_addresses&lt;/code&gt;) and re-run
&lt;code&gt;terraform apply&lt;/code&gt;. The new nodes will be created, they will use the machine config provisioning
API, received the latest configuration and join the cluster (take care to approve the corresponding
CSRs).&lt;/p&gt;
</description>
     </item>
   
     <item>
       <title>Setting up Hugo for GitHub hosting</title>
       <link>http://notes.georgiadis.online/posts/setting-up-hugo-github/</link>
       <pubDate>Sun, 02 Aug 2020 13:39:02 +0300</pubDate>
       
       <guid>http://notes.georgiadis.online/posts/setting-up-hugo-github/</guid>
       <description>&lt;p&gt;I&amp;rsquo;ve been meaning to setup a technical blog as the place to publish some of the notes I&amp;rsquo;ve been
traditionally gathering in Evernote notebooks. I&amp;rsquo;m also a huge fan of Inception. So here are the
steps you need to take in order to use Hugo to publish a technical blog on GitHub pages.&lt;/p&gt;
&lt;h2 id=&#34;why-hugo&#34;&gt;Why Hugo?&lt;/h2&gt;
&lt;p&gt;Hugo recently came up on my Twitter feed (which also kickstarted my latest attempt on public technical
blogging). I also dislike Ruby and all its derivatives, so Jekyll was out of the question. ðŸ˜„&lt;/p&gt;
&lt;h2 id=&#34;setup-on-mac&#34;&gt;Setup on Mac&lt;/h2&gt;
&lt;p&gt;I use Homebrew on my Mac, so setting up the client-side was all about following
&lt;a href=&#34;https://gohugo.io/getting-started/installing/#macos&#34;&gt;the relevant instructions&lt;/a&gt;.
After that I used the &lt;a href=&#34;https://gohugo.io/getting-started/quick-start/&#34;&gt;Quickstart guide&lt;/a&gt;. I&amp;rsquo;m giving
VS Code another go, so installed a few extensions (Hugo Language And Syntax Support, Better TOML)
along with the IntelliJ IDEA Keybindings to assist the muscle memory.&lt;/p&gt;
&lt;h2 id=&#34;setup-on-github&#34;&gt;Setup on GitHub&lt;/h2&gt;
&lt;p&gt;I chose to publish the blog as a user site (see &lt;a href=&#34;https://docs.github.com/en/github/working-with-github-pages/about-github-pages#types-of-github-pages-sites&#34;&gt;Types of GitHub Pages sites&lt;/a&gt;)
, so I followed again the Hugo documentation on how to &lt;a href=&#34;https://gohugo.io/hosting-and-deployment/hosting-on-github/&#34;&gt;Host on GitHub&lt;/a&gt;. Briefly:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Created a private &lt;code&gt;blog&lt;/code&gt; repository that is tracking Hugoâ€™s content and other source files&lt;/li&gt;
&lt;li&gt;Created &lt;code&gt;mranest.github.io&lt;/code&gt; repository that is added under &lt;code&gt;public&lt;/code&gt; folder as a submodule&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I also chose to use a custom domain for the blog and followed the corresponding documentation for
&lt;a href=&#34;https://docs.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site&#34;&gt;Managing a custom domain for your GitHub Pages site&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;other-links&#34;&gt;Other links&lt;/h2&gt;
&lt;p&gt;Here are some other links, and some TODO items for future improvements.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/spech66/hugo-best-practices&#34;&gt;Hugo best practices&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.webfx.com/tools/emoji-cheat-sheet/&#34;&gt;Emoji cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://gohugo.io/content-management/syntax-highlighting/#list-of-chroma-highlighting-languages&#34;&gt;List of Chrome Highlighting Languages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aaronluna.dev/blog/add-copy-button-to-code-blocks-hugo-chroma/&#34;&gt;Hugo: Add Copy-to-Clipboard Button to Code Blocks with Vanilla JS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
     </item>
   
 </channel>
</rss>
